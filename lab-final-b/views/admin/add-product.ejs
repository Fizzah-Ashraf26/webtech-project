<%- include('../partials/admin-header') %>

<div class="admin-content">
    <div class="card">
        <div class="card-header">
            <i class="fas fa-<%= product ? 'edit' : 'plus' %>-circle me-2"></i>
            <%= product ? 'Edit' : 'Add New' %> Product
        </div>
        <div class="card-body">

            <% if (error) { %>
                <div class="alert alert-danger mb-4">
                    <i class="fas fa-exclamation-triangle me-2"></i><%= error %>
                </div>
            <% } %>

            <form action="<%= product ? `/admin/products/${product._id}` : '/admin/products' %>" 
                  method="POST" 
                  enctype="multipart/form-data">

                <div class="row g-4 mb-4">
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Product Name <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" name="name" value="<%= product?.name || '' %>" required>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Price (Rs.) <span class="text-danger">*</span></label>
                        <input type="number" class="form-control" name="price" value="<%= product?.price || '' %>" min="0" step="0.01" required>
                    </div>
                </div>

                <div class="row g-4 mb-4">
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Category <span class="text-danger">*</span></label>
                        <select class="form-select" name="category" required>
                            <option value="">Choose category...</option>
                            <% categories.forEach(category => { %>
                                <option value="<%= category %>" <%= (product?.category === category) ? 'selected' : '' %>><%= category %></option>
                            <% }) %>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Stock <span class="text-danger">*</span></label>
                        <input type="number" class="form-control" name="stock" value="<%= product?.stock || '' %>" min="0" required>
                    </div>
                </div>

                <div class="row g-4 mb-4">
                    <div class="col-md-8">
                        <label class="form-label fw-bold">Description <span class="text-danger">*</span></label>
                        <textarea class="form-control" name="description" rows="4" required style="resize: vertical;"><%= product?.description || '' %></textarea>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-bold">Upload Image <span class="text-danger">*</span></label>
                        <input type="file" class="form-control" name="image" accept="image/*" <%= product ? '' : 'required' %>>
                        <% if (product?.image) { %>
                            <div class="mt-3">
                                <img src="/images/<%= product.image %>" alt="Preview" class="img-thumbnail" style="width: 100%; max-height: 150px;">
                            </div>
                        <% } %>
                    </div>
                </div>

                <div class="row g-4 mb-4">
                    <div class="col-md-6">
                        <label class="form-label fw-bold">Rating (0-5)</label>
                        <input type="number" class="form-control" name="rating" value="<%= product?.rating || '' %>" min="0" max="5" step="0.1">
                    </div>
                </div>

                <div class="d-flex gap-3">
                    <button type="submit" class="btn btn-primary px-4 py-2 fs-6">
                        <i class="fas fa-save me-2"></i> <%= product ? 'Update Product' : 'Create Product' %>
                    </button>
                    <a href="/admin/products" class="btn btn-secondary px-4 py-2 fs-6">
                        <i class="fas fa-arrow-left me-2"></i>Cancel
                    </a>
                </div>
            </form>

        </div>
    </div>
</div>

<%- include('../partials/admin-footer') %>
